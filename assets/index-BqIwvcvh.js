import{s as e,d as t,u as n,a as s,c as o,p as r,r as a,w as i,h as l,n as c,b as u,i as f,e as d,F as h,f as m,g as p,j as g,o as y,k as v,l as b,m as w,t as k,q as C,v as O,x,y as S,z as L,A as E,B as M,C as z,D as I,E as P,G as $}from"./vendor-CMmX-Ayj.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();
/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */
const R="undefined"!=typeof document;function T(e){return"object"==typeof e||"displayName"in e||"props"in e||"__vccOpts"in e}const A=Object.assign;function V(e,t){const n={};for(const s in t){const o=t[s];n[s]=_(o)?o.map(e):e(o)}return n}const j=()=>{},_=Array.isArray,D=/#/g,q=/&/g,U=/\//g,F=/=/g,Q=/\?/g,G=/\+/g,H=/%5B/g,B=/%5D/g,N=/%5E/g,W=/%60/g,K=/%7B/g,X=/%7C/g,J=/%7D/g,Y=/%20/g;function Z(e){return encodeURI(""+e).replace(X,"|").replace(H,"[").replace(B,"]")}function ee(e){return Z(e).replace(G,"%2B").replace(Y,"+").replace(D,"%23").replace(q,"%26").replace(W,"`").replace(K,"{").replace(J,"}").replace(N,"^")}function te(e){return ee(e).replace(F,"%3D")}function ne(e){return null==e?"":function(e){return Z(e).replace(D,"%23").replace(Q,"%3F")}(e).replace(U,"%2F")}function se(e){try{return decodeURIComponent(""+e)}catch(t){}return""+e}const oe=/\/$/;function re(e,t,n="/"){let s,o={},r="",a="";const i=t.indexOf("#");let l=t.indexOf("?");return i<l&&i>=0&&(l=-1),l>-1&&(s=t.slice(0,l),r=t.slice(l+1,i>-1?i:t.length),o=e(r)),i>-1&&(s=s||t.slice(0,i),a=t.slice(i,t.length)),s=function(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),s=e.split("/"),o=s[s.length-1];".."!==o&&"."!==o||s.push("");let r,a,i=n.length-1;for(r=0;r<s.length;r++)if(a=s[r],"."!==a){if(".."!==a)break;i>1&&i--}return n.slice(0,i).join("/")+"/"+s.slice(r).join("/")}(null!=s?s:t,n),{fullPath:s+(r&&"?")+r+a,path:s,query:o,hash:se(a)}}function ae(e,t){return t&&e.toLowerCase().startsWith(t.toLowerCase())?e.slice(t.length)||"/":e}function ie(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function le(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!ce(e[n],t[n]))return!1;return!0}function ce(e,t){return _(e)?ue(e,t):_(t)?ue(t,e):e===t}function ue(e,t){return _(t)?e.length===t.length&&e.every((e,n)=>e===t[n]):1===e.length&&e[0]===t}const fe={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var de,he,me,pe;function ge(e){if(!e)if(R){const t=document.querySelector("base");e=(e=t&&t.getAttribute("href")||"/").replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return"/"!==e[0]&&"#"!==e[0]&&(e="/"+e),e.replace(oe,"")}(he=de||(de={})).pop="pop",he.push="push",(pe=me||(me={})).back="back",pe.forward="forward",pe.unknown="";const ye=/^[^#]+#/;function ve(e,t){return e.replace(ye,"#")+t}const be=()=>({left:window.scrollX,top:window.scrollY});function we(e){let t;if("el"in e){const n=e.el,s="string"==typeof n&&n.startsWith("#"),o="string"==typeof n?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;t=function(e,t){const n=document.documentElement.getBoundingClientRect(),s=e.getBoundingClientRect();return{behavior:t.behavior,left:s.left-n.left-(t.left||0),top:s.top-n.top-(t.top||0)}}(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(null!=t.left?t.left:window.scrollX,null!=t.top?t.top:window.scrollY)}function ke(e,t){return(history.state?history.state.position-t:-1)+e}const Ce=new Map;function Oe(e,t){const{pathname:n,search:s,hash:o}=t,r=e.indexOf("#");if(r>-1){let t=o.includes(e.slice(r))?e.slice(r).length:1,n=o.slice(t);return"/"!==n[0]&&(n="/"+n),ae(n,"")}return ae(n,e)+s+o}function xe(e,t,n,s=!1,o=!1){return{back:e,current:t,forward:n,replaced:s,position:window.history.length,scroll:o?be():null}}function Se(e){const{history:t,location:n}=window,s={value:Oe(e,n)},o={value:t.state};function r(s,r,a){const i=e.indexOf("#"),l=i>-1?(n.host&&document.querySelector("base")?e:e.slice(i))+s:location.protocol+"//"+location.host+e+s;try{t[a?"replaceState":"pushState"](r,"",l),o.value=r}catch(c){console.error(c),n[a?"replace":"assign"](l)}}return o.value||r(s.value,{back:null,current:s.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0),{location:s,state:o,push:function(e,n){const a=A({},o.value,t.state,{forward:e,scroll:be()});r(a.current,a,!0),r(e,A({},xe(s.value,e,null),{position:a.position+1},n),!1),s.value=e},replace:function(e,n){r(e,A({},t.state,xe(o.value.back,e,o.value.forward,!0),n,{position:o.value.position}),!0),s.value=e}}}function Le(e){const t=Se(e=ge(e)),n=function(e,t,n,s){let o=[],r=[],a=null;const i=({state:r})=>{const i=Oe(e,location),l=n.value,c=t.value;let u=0;if(r){if(n.value=i,t.value=r,a&&a===l)return void(a=null);u=c?r.position-c.position:0}else s(i);o.forEach(e=>{e(n.value,l,{delta:u,type:de.pop,direction:u?u>0?me.forward:me.back:me.unknown})})};function l(){const{history:e}=window;e.state&&e.replaceState(A({},e.state,{scroll:be()}),"")}return window.addEventListener("popstate",i),window.addEventListener("beforeunload",l,{passive:!0}),{pauseListeners:function(){a=n.value},listen:function(e){o.push(e);const t=()=>{const t=o.indexOf(e);t>-1&&o.splice(t,1)};return r.push(t),t},destroy:function(){for(const e of r)e();r=[],window.removeEventListener("popstate",i),window.removeEventListener("beforeunload",l)}}}(e,t.state,t.location,t.replace);const s=A({location:"",base:e,go:function(e,t=!0){t||n.pauseListeners(),history.go(e)},createHref:ve.bind(null,e)},t,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function Ee(e){return"string"==typeof e||"symbol"==typeof e}const Me=Symbol("");var ze,Ie;function Pe(e,t){return A(new Error,{type:e,[Me]:!0},t)}function $e(e,t){return e instanceof Error&&Me in e&&(null==t||!!(e.type&t))}(Ie=ze||(ze={}))[Ie.aborted=4]="aborted",Ie[Ie.cancelled=8]="cancelled",Ie[Ie.duplicated=16]="duplicated";const Re="[^/]+?",Te={sensitive:!1,strict:!1,start:!0,end:!0},Ae=/[.+*?^${}()[\]/\\]/g;function Ve(e,t){let n=0;for(;n<e.length&&n<t.length;){const s=t[n]-e[n];if(s)return s;n++}return e.length<t.length?1===e.length&&80===e[0]?-1:1:e.length>t.length?1===t.length&&80===t[0]?1:-1:0}function je(e,t){let n=0;const s=e.score,o=t.score;for(;n<s.length&&n<o.length;){const e=Ve(s[n],o[n]);if(e)return e;n++}if(1===Math.abs(o.length-s.length)){if(_e(s))return 1;if(_e(o))return-1}return o.length-s.length}function _e(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const De={type:0,value:""},qe=/[a-zA-Z0-9_]/;function Ue(e,t,n){const s=function(e,t){const n=A({},Te,t),s=[];let o=n.start?"^":"";const r=[];for(const l of e){const e=l.length?[]:[90];n.strict&&!l.length&&(o+="/");for(let t=0;t<l.length;t++){const s=l[t];let a=40+(n.sensitive?.25:0);if(0===s.type)t||(o+="/"),o+=s.value.replace(Ae,"\\$&"),a+=40;else if(1===s.type){const{value:e,repeatable:n,optional:c,regexp:u}=s;r.push({name:e,repeatable:n,optional:c});const f=u||Re;if(f!==Re){a+=10;try{new RegExp(`(${f})`)}catch(i){throw new Error(`Invalid custom RegExp for param "${e}" (${f}): `+i.message)}}let d=n?`((?:${f})(?:/(?:${f}))*)`:`(${f})`;t||(d=c&&l.length<2?`(?:/${d})`:"/"+d),c&&(d+="?"),o+=d,a+=20,c&&(a+=-8),n&&(a+=-20),".*"===f&&(a+=-50)}e.push(a)}s.push(e)}if(n.strict&&n.end){const e=s.length-1;s[e][s[e].length-1]+=.7000000000000001}n.strict||(o+="/?"),n.end?o+="$":n.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const a=new RegExp(o,n.sensitive?"":"i");return{re:a,score:s,keys:r,parse:function(e){const t=e.match(a),n={};if(!t)return null;for(let s=1;s<t.length;s++){const e=t[s]||"",o=r[s-1];n[o.name]=e&&o.repeatable?e.split("/"):e}return n},stringify:function(t){let n="",s=!1;for(const o of e){s&&n.endsWith("/")||(n+="/"),s=!1;for(const e of o)if(0===e.type)n+=e.value;else if(1===e.type){const{value:r,repeatable:a,optional:i}=e,l=r in t?t[r]:"";if(_(l)&&!a)throw new Error(`Provided param "${r}" is an array but it is not repeatable (* or + modifiers)`);const c=_(l)?l.join("/"):l;if(!c){if(!i)throw new Error(`Missing required param "${r}"`);o.length<2&&(n.endsWith("/")?n=n.slice(0,-1):s=!0)}n+=c}}return n||"/"}}}(function(e){if(!e)return[[]];if("/"===e)return[[De]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(e){throw new Error(`ERR (${n})/"${c}": ${e}`)}let n=0,s=n;const o=[];let r;function a(){r&&o.push(r),r=[]}let i,l=0,c="",u="";function f(){c&&(0===n?r.push({type:0,value:c}):1===n||2===n||3===n?(r.length>1&&("*"===i||"+"===i)&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),r.push({type:1,value:c,regexp:u,repeatable:"*"===i||"+"===i,optional:"*"===i||"?"===i})):t("Invalid state to consume buffer"),c="")}function d(){c+=i}for(;l<e.length;)if(i=e[l++],"\\"!==i||2===n)switch(n){case 0:"/"===i?(c&&f(),a()):":"===i?(f(),n=1):d();break;case 4:d(),n=s;break;case 1:"("===i?n=2:qe.test(i)?d():(f(),n=0,"*"!==i&&"?"!==i&&"+"!==i&&l--);break;case 2:")"===i?"\\"==u[u.length-1]?u=u.slice(0,-1)+i:n=3:u+=i;break;case 3:f(),n=0,"*"!==i&&"?"!==i&&"+"!==i&&l--,u="";break;default:t("Unknown state")}else s=n,n=4;return 2===n&&t(`Unfinished custom RegExp for param "${c}"`),f(),a(),o}(e.path),n),o=A(s,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function Fe(e,t){const n=[],s=new Map;function o(e,n,s){const i=!s,l=Ge(e);l.aliasOf=s&&s.record;const c=We(t,e),u=[l];if("alias"in e){const t="string"==typeof e.alias?[e.alias]:e.alias;for(const e of t)u.push(Ge(A({},l,{components:s?s.record.components:l.components,path:e,aliasOf:s?s.record:l})))}let f,d;for(const t of u){const{path:u}=t;if(n&&"/"!==u[0]){const e=n.record.path,s="/"===e[e.length-1]?"":"/";t.path=n.record.path+(u&&s+u)}if(f=Ue(t,n,c),s?s.alias.push(f):(d=d||f,d!==f&&d.alias.push(f),i&&e.name&&!Be(f)&&r(e.name)),Ke(f)&&a(f),l.children){const e=l.children;for(let t=0;t<e.length;t++)o(e[t],f,s&&s.children[t])}s=s||f}return d?()=>{r(d)}:j}function r(e){if(Ee(e)){const t=s.get(e);t&&(s.delete(e),n.splice(n.indexOf(t),1),t.children.forEach(r),t.alias.forEach(r))}else{const t=n.indexOf(e);t>-1&&(n.splice(t,1),e.record.name&&s.delete(e.record.name),e.children.forEach(r),e.alias.forEach(r))}}function a(e){const t=function(e,t){let n=0,s=t.length;for(;n!==s;){const o=n+s>>1;je(e,t[o])<0?s=o:n=o+1}const o=function(e){let t=e;for(;t=t.parent;)if(Ke(t)&&0===je(e,t))return t;return}(e);o&&(s=t.lastIndexOf(o,s-1));return s}(e,n);n.splice(t,0,e),e.record.name&&!Be(e)&&s.set(e.record.name,e)}return t=We({strict:!1,end:!0,sensitive:!1},t),e.forEach(e=>o(e)),{addRoute:o,resolve:function(e,t){let o,r,a,i={};if("name"in e&&e.name){if(o=s.get(e.name),!o)throw Pe(1,{location:e});a=o.record.name,i=A(Qe(t.params,o.keys.filter(e=>!e.optional).concat(o.parent?o.parent.keys.filter(e=>e.optional):[]).map(e=>e.name)),e.params&&Qe(e.params,o.keys.map(e=>e.name))),r=o.stringify(i)}else if(null!=e.path)r=e.path,o=n.find(e=>e.re.test(r)),o&&(i=o.parse(r),a=o.record.name);else{if(o=t.name?s.get(t.name):n.find(e=>e.re.test(t.path)),!o)throw Pe(1,{location:e,currentLocation:t});a=o.record.name,i=A({},t.params,e.params),r=o.stringify(i)}const l=[];let c=o;for(;c;)l.unshift(c.record),c=c.parent;return{name:a,path:r,params:i,matched:l,meta:Ne(l)}},removeRoute:r,clearRoutes:function(){n.length=0,s.clear()},getRoutes:function(){return n},getRecordMatcher:function(e){return s.get(e)}}}function Qe(e,t){const n={};for(const s of t)s in e&&(n[s]=e[s]);return n}function Ge(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:He(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function He(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const s in e.components)t[s]="object"==typeof n?n[s]:n;return t}function Be(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Ne(e){return e.reduce((e,t)=>A(e,t.meta),{})}function We(e,t){const n={};for(const s in e)n[s]=s in t?t[s]:e[s];return n}function Ke({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Xe(e){const t={};if(""===e||"?"===e)return t;const n=("?"===e[0]?e.slice(1):e).split("&");for(let s=0;s<n.length;++s){const e=n[s].replace(G," "),o=e.indexOf("="),r=se(o<0?e:e.slice(0,o)),a=o<0?null:se(e.slice(o+1));if(r in t){let e=t[r];_(e)||(e=t[r]=[e]),e.push(a)}else t[r]=a}return t}function Je(e){let t="";for(let n in e){const s=e[n];if(n=te(n),null==s){void 0!==s&&(t+=(t.length?"&":"")+n);continue}(_(s)?s.map(e=>e&&ee(e)):[s&&ee(s)]).forEach(e=>{void 0!==e&&(t+=(t.length?"&":"")+n,null!=e&&(t+="="+e))})}return t}function Ye(e){const t={};for(const n in e){const s=e[n];void 0!==s&&(t[n]=_(s)?s.map(e=>null==e?null:""+e):null==s?s:""+s)}return t}const Ze=Symbol(""),et=Symbol(""),tt=Symbol(""),nt=Symbol(""),st=Symbol("");function ot(){let e=[];return{add:function(t){return e.push(t),()=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}},list:()=>e.slice(),reset:function(){e=[]}}}function rt(e,t,n,s,o,r=e=>e()){const a=s&&(s.enterCallbacks[o]=s.enterCallbacks[o]||[]);return()=>new Promise((i,l)=>{const c=e=>{var r;!1===e?l(Pe(4,{from:n,to:t})):e instanceof Error?l(e):"string"==typeof(r=e)||r&&"object"==typeof r?l(Pe(2,{from:t,to:e})):(a&&s.enterCallbacks[o]===a&&"function"==typeof e&&a.push(e),i())},u=r(()=>e.call(s&&s.instances[o],t,n,c));let f=Promise.resolve(u);e.length<3&&(f=f.then(c)),f.catch(e=>l(e))})}function at(e,t,n,s,o=e=>e()){const r=[];for(const a of e)for(const e in a.components){let i=a.components[e];if("beforeRouteEnter"===t||a.instances[e])if(T(i)){const l=(i.__vccOpts||i)[t];l&&r.push(rt(l,n,s,a,e,o))}else{let l=i();r.push(()=>l.then(r=>{if(!r)throw new Error(`Couldn't resolve component "${e}" at "${a.path}"`);const i=(l=r).__esModule||"Module"===l[Symbol.toStringTag]||l.default&&T(l.default)?r.default:r;var l;a.mods[e]=r,a.components[e]=i;const c=(i.__vccOpts||i)[t];return c&&rt(c,n,s,a,e,o)()}))}}return r}function it(e){const t=f(tt),s=f(nt),r=o(()=>{const s=n(e.to);return t.resolve(s)}),a=o(()=>{const{matched:e}=r.value,{length:t}=e,n=e[t-1],o=s.matched;if(!n||!o.length)return-1;const a=o.findIndex(ie.bind(null,n));if(a>-1)return a;const i=ct(e[t-2]);return t>1&&ct(n)===i&&o[o.length-1].path!==i?o.findIndex(ie.bind(null,e[t-2])):a}),i=o(()=>a.value>-1&&function(e,t){for(const n in t){const s=t[n],o=e[n];if("string"==typeof s){if(s!==o)return!1}else if(!_(o)||o.length!==s.length||s.some((e,t)=>e!==o[t]))return!1}return!0}(s.params,r.value.params)),l=o(()=>a.value>-1&&a.value===s.matched.length-1&&le(s.params,r.value.params));return{route:r,href:o(()=>r.value.href),isActive:i,isExactActive:l,navigate:function(s={}){if(function(e){if(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)return;if(e.defaultPrevented)return;if(void 0!==e.button&&0!==e.button)return;if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}e.preventDefault&&e.preventDefault();return!0}(s)){const s=t[n(e.replace)?"replace":"push"](n(e.to)).catch(j);return e.viewTransition&&"undefined"!=typeof document&&"startViewTransition"in document&&document.startViewTransition(()=>s),s}return Promise.resolve()}}}const lt=t({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:it,setup(e,{slots:t}){const n=u(it(e)),{options:s}=f(tt),r=o(()=>({[ut(e.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[ut(e.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const s=t.default&&(1===(o=t.default(n)).length?o[0]:o);var o;return e.custom?s:l("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},s)}}});function ct(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const ut=(e,t,n)=>null!=e?e:null!=t?t:n;function ft(e,t){if(!e)return null;const n=e(t);return 1===n.length?n[0]:n}const dt=t({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:s}){const c=f(st),u=o(()=>e.route||c.value),d=f(et,0),h=o(()=>{let e=n(d);const{matched:t}=u.value;let s;for(;(s=t[e])&&!s.components;)e++;return e}),m=o(()=>u.value.matched[h.value]);r(et,o(()=>h.value+1)),r(Ze,m),r(st,u);const p=a();return i(()=>[p.value,m.value,e.name],([e,t,n],[s,o,r])=>{t&&(t.instances[n]=e,o&&o!==t&&e&&e===s&&(t.leaveGuards.size||(t.leaveGuards=o.leaveGuards),t.updateGuards.size||(t.updateGuards=o.updateGuards))),!e||!t||o&&ie(t,o)&&s||(t.enterCallbacks[n]||[]).forEach(t=>t(e))},{flush:"post"}),()=>{const n=u.value,o=e.name,r=m.value,a=r&&r.components[o];if(!a)return ft(s.default,{Component:a,route:n});const i=r.props[o],c=i?!0===i?n.params:"function"==typeof i?i(n):i:null,f=l(a,A({},c,t,{onVnodeUnmounted:e=>{e.component.isUnmounted&&(r.instances[o]=null)},ref:p}));return ft(s.default,{Component:f,route:n})||f}}});const ht=d("stores",{state:()=>({allStores:[],searchQuery:"",filters:{region:"",category:"",offerType:"",employeeOnly:!1,communityRecommended:!1},userLocation:null,userPreferences:{favoriteCategories:[],favoriteOfferTypes:[],frequentRegions:[],budgetRange:""},isLoading:!1,error:null,currentCompanyId:null}),getters:{channelOffers:e=>{const t=[];let n=e.allStores.filter(e=>!e.lat||!e.lng||null===e.lat||null===e.lng);return e.filters.category&&(n=n.filter(t=>t.category===e.filters.category)),n.forEach(n=>{n.offers&&n.offers.filter(t=>!e.filters.employeeOnly||!0===t.isEmployeeOffer).filter(t=>!e.filters.communityRecommended||(t.communityRecommended||t.featured)).forEach(e=>{t.push({...e,store:{id:n.id,name:n.name,address:n.address,phone:n.phone,category:n.category,openingHours:n.openingHours,lat:n.lat,lng:n.lng}})})}),t},nearbyPhysicalOffers:e=>{if(!e.userLocation)return[];const t=[];return e.allStores.filter(e=>e.lat&&e.lng&&null!==e.lat&&null!==e.lng).forEach(n=>{if(n.offers){const s=mt(e.userLocation.lat,e.userLocation.lng,n.lat,n.lng);s<=5&&n.offers.filter(t=>!e.filters.employeeOnly||!0===t.isEmployeeOffer).filter(t=>!e.filters.communityRecommended||(t.communityRecommended||t.featured)).forEach(e=>{t.push({...e,store:{id:n.id,name:n.name,address:n.address,phone:n.phone,category:n.category,openingHours:n.openingHours,lat:n.lat,lng:n.lng},distance:s})})}}),t.sort((e,t)=>e.distance-t.distance)},nearbyOffers:e=>{if(!e.userLocation)return[];const t=[];return e.allStores.forEach(n=>{if(n.offers){const s=mt(e.userLocation.lat,e.userLocation.lng,n.lat,n.lng);s<=5&&n.offers.forEach(e=>{t.push({...e,store:{id:n.id,name:n.name,address:n.address,phone:n.phone,category:n.category,openingHours:n.openingHours,lat:n.lat,lng:n.lng},distance:s})})}}),t.sort((e,t)=>e.distance-t.distance)},filteredStores:e=>{let t=[...e.allStores];if(e.filters.region&&(t=t.filter(t=>t.region===e.filters.region)),e.filters.category&&(t=t.filter(t=>t.category===e.filters.category)),e.filters.offerType&&(t=t.filter(t=>t.offers&&t.offers.some(t=>t.type===e.filters.offerType))),e.searchQuery){t=new h(t,{keys:["name","address","description","category","offers.title","offers.description"],threshold:.3,includeScore:!0}).search(e.searchQuery).map(e=>e.item)}return t},availableRegions:e=>[...new Set(e.allStores.map(e=>e.region))].sort(),availableCategories:e=>[...new Set(e.allStores.map(e=>e.category))].sort(),channelOfferCategories:e=>[...new Set(e.allStores.filter(e=>!e.lat||!e.lng||null===e.lat||null===e.lng).filter(e=>e.offers&&e.offers.length>0).map(e=>e.category).filter(e=>e&&""!==e.trim()))].sort(),availableOfferTypes:e=>{const t=[];return e.allStores.forEach(e=>{e.offers&&e.offers.forEach(e=>{t.includes(e.type)||t.push(e.type)})}),t.sort()},storeCount:e=>e.filteredStores.length},actions:{async loadStores(e){if(!e)return void(this.error="未指定公司代號");if(this.currentCompanyId===e&&this.allStores.length>0)return;this.isLoading=!0,this.error=null,this.allStores=[];const t=`https://script.google.com/macros/s/AKfycbxZXmuRtpzQjWxT7MdzH2AxK_DM8vwpMmksoINlI6dhUxViba8yy2ODdqV48vR876hI/exec?companyId=${e}`;try{const n=await fetch(t),s=await n.json();if(!n.ok||s.error)throw new Error(s.error||"從 API 載入資料失敗");this.allStores=s,this.currentCompanyId=e}catch(n){this.error=n.message,console.error("載入資料失敗:",n)}finally{this.isLoading=!1}},setSearchQuery(e){this.searchQuery=e},setFilters(e){this.filters={...this.filters,...e}},clearFilters(){this.filters={region:"",category:"",offerType:"",employeeOnly:!1,communityRecommended:!1}},clearSearch(){this.searchQuery=""},setUserLocation(e){this.userLocation=e},clearUserLocation(){this.userLocation=null},async getCurrentLocation(){return new Promise((e,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const n={lat:t.coords.latitude,lng:t.coords.longitude};this.setUserLocation(n),e(n)},e=>{let n="無法取得您的位置";switch(e.code){case e.PERMISSION_DENIED:n="位置存取權限被拒絕";break;case e.POSITION_UNAVAILABLE:n="位置資訊不可用";break;case e.TIMEOUT:n="位置請求超時"}t(new Error(n))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5}):t(new Error("此瀏覽器不支援地理定位功能"))})},setUserPreferences(e){this.userPreferences={...this.userPreferences,...e},localStorage.setItem("userPreferences",JSON.stringify(this.userPreferences))},loadUserPreferences(){const e=localStorage.getItem("userPreferences");e&&(this.userPreferences={...this.userPreferences,...JSON.parse(e)})}}});function mt(e,t,n,s){const o=pt(n-e),r=pt(s-t),a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(pt(e))*Math.cos(pt(n))*Math.sin(r/2)*Math.sin(r/2);return+(6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))).toFixed(1)}function pt(e){return e*(Math.PI/180)}const gt=(e,t)=>{const n=e.__vccOpts||e;for(const[s,o]of t)n[s]=o;return n},yt={name:"Icon",props:{name:{type:String,required:!0},size:{type:String,default:"sm",validator:e=>["sm","md","lg"].includes(e)},spacing:{type:String,default:"md",validator:e=>["sm","md","lg","none"].includes(e)},type:{type:String,default:"custom",validator:e=>["button","info","action","custom"].includes(e)},ariaLabel:{type:String,default:null},ariaHidden:{type:Boolean,default:!0}},computed:{iconClasses(){const e=["icon"];return"custom"!==this.type?e.push(`icon-${this.type}`):(e.push(`icon-${this.size}`),"none"!==this.spacing&&e.push(`icon-spacing-${this.spacing}`)),e},iconPath(){const e={search:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",close:"M6 18L18 6M6 6l12 12",filter:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z",sort:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12",location:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z M15 11a3 3 0 11-6 0 3 3 0 016 0z","location-simple":"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z",navigation:"M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 00.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z",phone:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z",clock:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z",star:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z",check:"M5 13l4 4L19 7","check-circle":"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",info:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",error:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",category:"M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z",trash:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"};return e[this.name]||e.info}}},vt=["aria-hidden","aria-label"],bt=["d"];const wt=gt(yt,[["render",function(e,t,n,s,o,r){return y(),m("svg",{class:g(r.iconClasses),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":n.ariaHidden,"aria-label":n.ariaLabel},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:r.iconPath},null,8,bt)],10,vt)}],["__scopeId","data-v-1b994658"]]),kt=["aria-label"],Ct={class:"offer-badges"},Ot={key:0,class:"community-badge"},xt={key:2,class:"offer-badge community-only"},St={class:"offer-header"},Lt={class:"offer-title"},Et={class:"store-info"},Mt={class:"store-main"},zt={class:"store-name"},It={key:0,class:"distance-info"},Pt={class:"distance"},$t={class:"walk-time"},Rt={class:"store-meta"},Tt={class:"category"},At={class:"offer-description"},Vt={class:"offer-validity"},jt={class:"quick-actions"};const _t={class:"custom-location-input"},Dt={class:"input-header"},qt={class:"search-container"},Ut={class:"input-wrapper"},Ft=["disabled"],Qt=["disabled"],Gt={key:0,class:"suggestions-dropdown"},Ht=["onClick"],Bt={class:"suggestion-content"},Nt={class:"suggestion-text"},Wt={class:"suggestion-address"},Kt={class:"quick-locations"},Xt={class:"quick-buttons"},Jt=["onClick","disabled"],Yt={key:0,class:"error-message"},Zt={key:1,class:"selected-location"},en={class:"selected-header"},tn={class:"selected-content"},nn={class:"selected-text"},sn={class:"selected-address"};const on={name:"OfferList",components:{OfferCard:gt({name:"OfferCard",components:{Icon:wt},props:{offer:{type:Object,required:!0}},computed:{walkTime(){if(null==this.offer.distance)return 0;const e=this.offer.distance/5,t=Math.round(60*e);return Math.max(1,t)}},methods:{handleCardClick(e){e&&"keydown"===e.type&&"Space"===e.code&&e.preventDefault(),this.$emit("offer-click",this.offer)},callStore(){window.open(`tel:${this.offer.store.phone}`)},getDirections(){if(this.offer.store.lat&&this.offer.store.lng){const e=`https://www.google.com/maps/dir/current+location/${this.offer.store.lat},${this.offer.store.lng}`;window.open(e,"_blank")}else{const e=`https://www.google.com/maps/search/${encodeURIComponent(this.offer.store.name+" "+(this.offer.store.address||""))}`;window.open(e,"_blank")}},getOfferIcon:e=>({discount:"percentage",cashback:"dollar",gift:"gift",member:"user",bundle:"package"}[e]||"tag"),getOfferTypeLabel:e=>({discount:"折扣",cashback:"回饋",gift:"贈品",member:"會員",bundle:"套餐"}[e]||"優惠"),formatValidityDate(e){const t=new Date(e)-new Date,n=Math.ceil(t/864e5);return n<0?"已過期":0===n?"今日截止":1===n?"明日截止":n<=7?`${n}天後截止`:n<=30?`${Math.ceil(n/7)}週後截止`:"長期有效"},getValidityClass(e){const t=new Date(e)-new Date,n=Math.ceil(t/864e5);return n<0?"expired":n<=3?"urgent":n<=7?"soon":"normal"}},emits:["offer-click"]},[["render",function(e,t,n,s,o,r){const a=w("Icon");return y(),m("article",{class:"offer-card",onClick:t[2]||(t[2]=(...e)=>r.handleCardClick&&r.handleCardClick(...e)),onKeydown:[t[3]||(t[3]=x((...e)=>r.handleCardClick&&r.handleCardClick(...e),["enter"])),t[4]||(t[4]=x((...e)=>r.handleCardClick&&r.handleCardClick(...e),["space"]))],tabindex:"0",role:"button","aria-label":`查看 ${n.offer.title} 的詳細資訊`},[p("div",Ct,[n.offer.communityRecommended||n.offer.featured?(y(),m("div",Ot,[b(a,{name:"heart",size:"sm"}),t[5]||(t[5]=p("span",null,"社群推薦",-1))])):v("",!0),null!==n.offer.isEmployeeOffer&&void 0!==n.offer.isEmployeeOffer?(y(),m("div",{key:1,class:g(["offer-badge",n.offer.isEmployeeOffer?"employee-badge":"public-badge"])},[b(a,{name:n.offer.isEmployeeOffer?"user":"users",size:"sm"},null,8,["name"]),p("span",null,k(n.offer.isEmployeeOffer?"員工專享":"一般優惠"),1)],2)):n.offer.communityRecommended||n.offer.featured?(y(),m("div",xt,[b(a,{name:"star",size:"sm"}),t[6]||(t[6]=p("span",null,"社群推薦",-1))])):v("",!0)]),p("div",St,[p("h3",Lt,k(n.offer.title),1),p("div",{class:g(["offer-type-badge",`type-${n.offer.type}`])},[b(a,{name:r.getOfferIcon(n.offer.type),size:"sm"},null,8,["name"]),C(" "+k(r.getOfferTypeLabel(n.offer.type)),1)],2)]),p("div",Et,[p("div",Mt,[p("h4",zt,k(n.offer.store.name),1),null!=n.offer.distance?(y(),m("div",It,[b(a,{name:"navigation",size:"sm",class:"text-blue-500"}),p("span",Pt,k(n.offer.distance)+"km",1),p("span",$t,"步行約 "+k(r.walkTime)+" 分",1)])):v("",!0)]),p("div",Rt,[p("span",Tt,k(n.offer.store.category),1)])]),p("div",At,[p("p",null,k(n.offer.description),1)]),p("div",Vt,[b(a,{name:"clock",size:"sm",class:"text-gray-500"}),p("span",{class:g(["validity-text",r.getValidityClass(n.offer.validUntil)])},k(r.formatValidityDate(n.offer.validUntil)),3)]),p("div",jt,[n.offer.store.phone?(y(),m("button",{key:0,onClick:t[0]||(t[0]=O((...e)=>r.callStore&&r.callStore(...e),["stop"])),class:"action-btn primary"},[b(a,{name:"phone",size:"sm"}),t[7]||(t[7]=C(" 撥打電話 "))])):v("",!0),p("button",{onClick:t[1]||(t[1]=O((...e)=>r.getDirections&&r.getDirections(...e),["stop"])),class:g(["action-btn",n.offer.store.phone?"secondary":"primary"])},[b(a,{name:"map",size:"sm"}),t[8]||(t[8]=C(" 查看路線 "))],2)])],40,kt)}],["__scopeId","data-v-ca41a08a"]]),CustomLocationInput:gt({name:"CustomLocationInput",components:{Icon:wt},data:()=>({searchQuery:"",suggestions:[],showSuggestions:!1,isSearching:!1,errorMessage:"",selectedLocation:null,debounceTimer:null,quickLocations:[{name:"台北車站",icon:"train",address:"台北市中正區北平西路3號"},{name:"信義區",icon:"building",address:"台北市信義區"},{name:"西門町",icon:"shopping",address:"台北市萬華區西門町"},{name:"東區",icon:"heart",address:"台北市大安區忠孝東路四段"}]}),methods:{handleInput(){if(this.errorMessage="",this.debounceTimer&&clearTimeout(this.debounceTimer),this.searchQuery.trim().length<2)return this.suggestions=[],void(this.showSuggestions=!1);this.debounceTimer=setTimeout(()=>{this.searchSuggestions()},300)},async searchSuggestions(){if(this.searchQuery.trim())try{const e=await this.geocodeAddress(this.searchQuery,!0);this.suggestions=e.slice(0,5),this.showSuggestions=!0}catch(e){console.error("搜尋建議失敗:",e),this.suggestions=[]}},async searchLocation(){if(this.searchQuery.trim()){this.isSearching=!0,this.errorMessage="",this.showSuggestions=!1;try{const e=await this.geocodeAddress(this.searchQuery);e&&e.length>0?this.selectedLocation=e[0]:this.errorMessage="找不到該地址，請嘗試更詳細的描述"}catch(e){this.errorMessage="搜尋失敗，請檢查網路連線或稍後再試",console.error("地址搜尋失敗:",e)}finally{this.isSearching=!1}}},async geocodeAddress(e,t=!1){const n=new URLSearchParams({f:"json",singleLine:e,maxLocations:t?5:1,outFields:"Match_addr,StAddr,City",countryCode:"TWN",category:t?"":"Address,POI,PointAddress,StreetAddress"}),s=await fetch(`https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates?${n}`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const o=await s.json();return o.candidates&&0!==o.candidates.length?o.candidates.map(e=>{var t;return{text:e.address,address:(null==(t=e.attributes)?void 0:t.Match_addr)||e.address,lat:e.location.y,lng:e.location.x,score:e.score}}):[]},selectSuggestion(e){this.selectedLocation=e,this.searchQuery=e.text,this.showSuggestions=!1,this.suggestions=[]},async selectQuickLocation(e){this.isSearching=!0,this.errorMessage="";try{const t=await this.geocodeAddress(e.address);t&&t.length>0&&(this.selectedLocation={...t[0],text:e.name,address:e.address},this.searchQuery=e.name)}catch(t){this.errorMessage="無法定位該位置，請嘗試手動搜尋",console.error("快速位置搜尋失敗:",t)}finally{this.isSearching=!1}},confirmLocation(){this.selectedLocation&&this.$emit("location-selected",{lat:this.selectedLocation.lat,lng:this.selectedLocation.lng,address:this.selectedLocation.address,name:this.selectedLocation.text})},handleClickOutside(e){this.$el.contains(e.target)||(this.showSuggestions=!1)}},mounted(){document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside),this.debounceTimer&&clearTimeout(this.debounceTimer)},emits:["location-selected"]},[["render",function(e,t,n,s,o,r){const a=w("Icon");return y(),m("div",_t,[p("div",Dt,[b(a,{name:"search",size:"sm",class:"text-primary"}),t[6]||(t[6]=p("h4",{class:"input-title"},"自定義位置",-1))]),p("div",qt,[p("div",Ut,[S(p("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.searchQuery=e),onInput:t[1]||(t[1]=(...e)=>r.handleInput&&r.handleInput(...e)),onKeydown:t[2]||(t[2]=x((...e)=>r.searchLocation&&r.searchLocation(...e),["enter"])),onFocus:t[3]||(t[3]=e=>o.showSuggestions=!0),type:"text",placeholder:"輸入地址、地標或區域名稱...",class:"location-input",disabled:o.isSearching},null,40,Ft),[[L,o.searchQuery]]),p("button",{onClick:t[4]||(t[4]=(...e)=>r.searchLocation&&r.searchLocation(...e)),disabled:!o.searchQuery.trim()||o.isSearching,class:"search-btn"},[b(a,{name:o.isSearching?"loading":"search",size:"sm",class:g({"animate-spin":o.isSearching})},null,8,["name","class"])],8,Qt)]),o.showSuggestions&&o.suggestions.length>0?(y(),m("div",Gt,[(y(!0),m(E,null,M(o.suggestions,(e,t)=>(y(),m("div",{key:t,onClick:t=>r.selectSuggestion(e),class:"suggestion-item"},[b(a,{name:"location",size:"sm",class:"text-gray-500"}),p("div",Bt,[p("div",Nt,k(e.text),1),p("div",Wt,k(e.address),1)])],8,Ht))),128))])):v("",!0)]),p("div",Kt,[t[7]||(t[7]=p("h5",{class:"quick-title"},"常用位置",-1)),p("div",Xt,[(y(!0),m(E,null,M(o.quickLocations,e=>(y(),m("button",{key:e.name,onClick:t=>r.selectQuickLocation(e),class:"quick-btn",disabled:o.isSearching},[b(a,{name:e.icon,size:"sm"},null,8,["name"]),p("span",null,k(e.name),1)],8,Jt))),128))])]),o.errorMessage?(y(),m("div",Yt,[b(a,{name:"warning",size:"sm",class:"text-red-500"}),p("span",null,k(o.errorMessage),1)])):v("",!0),o.selectedLocation?(y(),m("div",Zt,[p("div",en,[b(a,{name:"check-circle",size:"sm",class:"text-green-500"}),t[8]||(t[8]=p("span",{class:"selected-title"},"已選擇位置",-1))]),p("div",tn,[p("div",nn,k(o.selectedLocation.text),1),p("div",sn,k(o.selectedLocation.address),1)]),p("button",{onClick:t[5]||(t[5]=(...e)=>r.confirmLocation&&r.confirmLocation(...e)),class:"confirm-btn"},[b(a,{name:"check",size:"sm"}),t[9]||(t[9]=C(" 確認使用此位置 "))])])):v("",!0)])}],["__scopeId","data-v-65a88013"]]),Icon:wt},props:{offers:{type:Array,default:()=>[]},userLocation:{type:Object,default:null}},computed:{...z(ht,["channelOffers","nearbyPhysicalOffers","allStores","channelOfferCategories","filters"]),totalOffersCount(){return this.channelOffers.length+this.nearbyPhysicalOffers.length},allChannelOffersCount(){const e=[];return this.allStores.filter(e=>!e.lat||!e.lng||null===e.lat||null===e.lng).forEach(t=>{t.offers&&t.offers.filter(e=>e.isEmployeeOffer).forEach(t=>{e.push(t)})}),e.length}},data:()=>({currentView:"nearby",showCustomLocation:!1,showLocationOptions:!1,showCustomLocationInPanel:!1,showCustomLocationInEmptyState:!1}),methods:{handleOfferClick(e){this.$emit("offer-selected",e)},expandSearch(){console.log("Expand search radius to 10km"),this.$emit("expand-search",10)},handleCustomLocation(e){this.showCustomLocation=!1,this.$emit("custom-location-selected",e)},handlePanelLocationSelected(e){this.showLocationOptions=!1,this.showCustomLocationInPanel=!1,this.$emit("custom-location-selected",e)},handleEmptyStateLocationSelected(e){this.showCustomLocationInEmptyState=!1,this.$emit("custom-location-selected",e)},setCategoryFilter(e){ht().setFilters({category:e})},clearCategoryFilter(){ht().setFilters({category:""})},getCategoryCount(e){const t=[];return this.allStores.filter(e=>!e.lat||!e.lng||null===e.lat||null===e.lng).filter(t=>t.category===e).forEach(e=>{e.offers&&e.offers.filter(e=>e.isEmployeeOffer).forEach(e=>{t.push(e)})}),t.length},toggleEmployeeOnly(){ht().setFilters({employeeOnly:!this.filters.employeeOnly})},toggleCommunityRecommended(){ht().setFilters({communityRecommended:!this.filters.communityRecommended})}},emits:["offer-selected","get-location","expand-search","custom-location-selected"]},rn={class:"offer-list"},an={class:"simple-controls"},ln={class:"filter-toggles"},cn={key:0,class:"view-tabs"},un={key:0,class:"location-prompt"},fn={class:"prompt-content"},dn={class:"location-options"},hn={key:0,class:"custom-location-section"},mn={key:1,class:"offers-container"},pn={key:0,class:"location-change-panel"},gn={class:"panel-header"},yn={class:"location-options-panel"},vn={key:0,class:"custom-location-in-panel"},bn={key:1,class:"nearby-view"},wn={class:"results-summary"},kn={class:"summary-content"},Cn={class:"summary-title"},On={class:"location-actions"},xn={class:"location-info"},Sn={key:0},Ln={class:"offers-flow"},En={key:1,class:"no-nearby-offers"},Mn={class:"no-offers-content"},zn={class:"no-offers-actions"},In={key:2,class:"channel-view"},Pn={class:"results-summary"},$n={class:"summary-content"},Rn={class:"summary-title"},Tn={class:"summary-info"},An={class:"info-badge"},Vn={key:0,class:"category-filter"},jn={class:"filter-header"},_n={class:"filter-options"},Dn=["onClick"],qn={key:1},Un={class:"offers-flow"},Fn={key:2,class:"no-channel-offers"},Qn={class:"no-offers-content"},Gn={class:"no-offers-actions"},Hn={key:2,class:"no-offers-state"},Bn={class:"no-offers-content"},Nn={key:0,class:"channel-suggestion"},Wn={class:"suggestion-content"},Kn={class:"suggestion-title"},Xn={class:"no-offers-actions"},Jn={key:0,class:"custom-location-in-empty-state"},Yn={key:3,class:"search-tips"},Zn={class:"tips-title"};const es=gt(on,[["render",function(e,t,n,s,o,r){const a=w("Icon"),i=w("CustomLocationInput"),l=w("OfferCard");return y(),m("div",rn,[p("div",an,[p("div",ln,[p("button",{onClick:t[0]||(t[0]=(...e)=>r.toggleEmployeeOnly&&r.toggleEmployeeOnly(...e)),class:g([{active:e.filters.employeeOnly},"filter-toggle"])},k(e.filters.employeeOnly?"員工專享":"所有優惠"),3),p("button",{onClick:t[1]||(t[1]=(...e)=>r.toggleCommunityRecommended&&r.toggleCommunityRecommended(...e)),class:g([{active:e.filters.communityRecommended},"filter-toggle community"])},k(e.filters.communityRecommended?"社群推薦":"全部店家"),3)]),n.userLocation&&r.totalOffersCount>0?(y(),m("div",cn,[p("button",{onClick:t[2]||(t[2]=e=>o.currentView="nearby"),class:g([{active:"nearby"===o.currentView},"tab-btn"])}," 📍 附近 "+k(e.nearbyPhysicalOffers.length),3),p("button",{onClick:t[3]||(t[3]=e=>o.currentView="channel"),class:g([{active:"channel"===o.currentView},"tab-btn"])}," 👑 通用 "+k(e.channelOffers.length),3)])):v("",!0)]),n.userLocation?e.channelOffers.length>0||e.nearbyPhysicalOffers.length>0?(y(),m("div",mn,[o.showLocationOptions?(y(),m("div",pn,[p("div",gn,[t[23]||(t[23]=p("h4",{class:"panel-title"},"更改搜尋位置",-1)),p("button",{onClick:t[6]||(t[6]=e=>o.showLocationOptions=!1),class:"close-panel-btn"},[b(a,{name:"close",size:"sm"})])]),p("div",yn,[p("button",{onClick:t[7]||(t[7]=t=>{e.$emit("get-location"),o.showLocationOptions=!1}),class:"location-option-btn"},[b(a,{name:"navigation",size:"sm"}),t[24]||(t[24]=p("div",{class:"option-content"},[p("span",{class:"option-title"},"重新GPS定位"),p("span",{class:"option-desc"},"使用目前所在位置")],-1))]),p("button",{onClick:t[8]||(t[8]=e=>o.showCustomLocationInPanel=!o.showCustomLocationInPanel),class:"location-option-btn"},[b(a,{name:"search",size:"sm"}),t[25]||(t[25]=p("div",{class:"option-content"},[p("span",{class:"option-title"},"手動輸入地址"),p("span",{class:"option-desc"},"搜尋特定地點附近")],-1))])]),o.showCustomLocationInPanel?(y(),m("div",vn,[b(i,{onLocationSelected:r.handlePanelLocationSelected},null,8,["onLocationSelected"])])):v("",!0)])):v("",!0),"nearby"===o.currentView?(y(),m("div",bn,[p("div",wn,[p("div",kn,[b(a,{name:"navigation",class:"text-blue-500"}),p("h3",Cn,"附近 "+k(e.nearbyPhysicalOffers.length)+" 個優惠",1)]),p("div",On,[p("div",xn,[b(a,{name:"navigation",size:"sm",class:"text-blue-500"}),t[26]||(t[26]=p("span",{class:"location-text"},"5km 範圍內",-1))]),p("button",{onClick:t[9]||(t[9]=e=>o.showLocationOptions=!o.showLocationOptions),class:"change-location-btn"},[b(a,{name:"edit",size:"sm"}),t[27]||(t[27]=C(" 更改位置 "))])])]),e.nearbyPhysicalOffers.length>0?(y(),m("div",Sn,[p("div",Ln,[(y(!0),m(E,null,M(e.nearbyPhysicalOffers,(e,t)=>(y(),I(l,{key:`nearby-${e.store.id}-${e.title}-${t}`,offer:e,onOfferClick:r.handleOfferClick},null,8,["offer","onOfferClick"]))),128))])])):(y(),m("div",En,[p("div",Mn,[b(a,{name:"map-pin",size:"lg",class:"text-gray-400"}),t[30]||(t[30]=p("h3",{class:"no-offers-title"},"附近暫無實體店家優惠",-1)),t[31]||(t[31]=p("p",{class:"no-offers-text"}," 目前您附近 5km 內沒有實體店家提供優惠 ",-1)),p("div",zn,[p("button",{onClick:t[10]||(t[10]=t=>e.$emit("get-location")),class:"retry-btn"},[b(a,{name:"refresh",size:"sm"}),t[28]||(t[28]=C(" 重新定位 "))]),p("button",{onClick:t[11]||(t[11]=e=>o.currentView="channel"),class:"switch-view-btn"},[b(a,{name:"globe",size:"sm"}),t[29]||(t[29]=C(" 查看通用優惠 "))])])])]))])):v("",!0),"channel"===o.currentView?(y(),m("div",In,[p("div",Pn,[p("div",$n,[b(a,{name:"globe",class:"text-purple-500"}),p("h3",Rn,k(e.channelOffers.length)+" 個全通路優惠",1)]),p("div",Tn,[p("div",An,[b(a,{name:"check-circle",size:"sm",class:"text-green-500"}),t[32]||(t[32]=p("span",{class:"info-text"},"全通路適用",-1))])])]),e.channelOfferCategories.length>1?(y(),m("div",Vn,[p("div",jn,[b(a,{name:"filter",size:"sm",class:"text-gray-500"}),t[34]||(t[34]=p("span",{class:"filter-label"},"依類別篩選",-1)),e.filters.category?(y(),m("button",{key:0,onClick:t[12]||(t[12]=(...e)=>r.clearCategoryFilter&&r.clearCategoryFilter(...e)),class:"clear-filter-btn"},[b(a,{name:"close",size:"sm"}),t[33]||(t[33]=C(" 清除 "))])):v("",!0)]),p("div",_n,[p("button",{onClick:t[13]||(t[13]=e=>r.setCategoryFilter("")),class:g([{active:!e.filters.category},"filter-btn"])}," 全部類別 ("+k(r.allChannelOffersCount)+") ",3),(y(!0),m(E,null,M(e.channelOfferCategories,t=>(y(),m("button",{key:t,onClick:e=>r.setCategoryFilter(t),class:g([{active:e.filters.category===t},"filter-btn"])},k(t)+" ("+k(r.getCategoryCount(t))+") ",11,Dn))),128))])])):v("",!0),e.channelOffers.length>0?(y(),m("div",qn,[p("div",Un,[(y(!0),m(E,null,M(e.channelOffers,(e,t)=>(y(),I(l,{key:`channel-${e.store.id}-${e.title}-${t}`,offer:e,onOfferClick:r.handleOfferClick},null,8,["offer","onOfferClick"]))),128))])])):(y(),m("div",Fn,[p("div",Qn,[b(a,{name:"globe",size:"lg",class:"text-gray-400"}),t[36]||(t[36]=p("h3",{class:"no-offers-title"},"暫無通用優惠",-1)),t[37]||(t[37]=p("p",{class:"no-offers-text"}," 目前沒有全通路通用優惠 ",-1)),p("div",Gn,[p("button",{onClick:t[14]||(t[14]=e=>o.currentView="nearby"),class:"switch-view-btn"},[b(a,{name:"navigation",size:"sm"}),t[35]||(t[35]=C(" 查看附近優惠 "))])])])]))])):v("",!0)])):(y(),m("div",Hn,[p("div",Bn,[b(a,{name:"search",size:"lg",class:"text-gray-400"}),t[43]||(t[43]=p("h3",{class:"no-offers-title"},"附近暫無優惠",-1)),t[44]||(t[44]=p("p",{class:"no-offers-text"}," 目前您附近 5km 內沒有提供優惠的店家 ",-1)),e.channelOffers.length>0?(y(),m("div",Nn,[p("div",Wn,[b(a,{name:"lightbulb",size:"md",class:"text-yellow-500"}),p("h4",Kn,"但是有 "+k(e.channelOffers.length)+" 個全通路優惠！",1),t[38]||(t[38]=p("p",{class:"suggestion-text"},"這些優惠可以在任何地點使用，不受位置限制",-1))]),p("button",{onClick:t[15]||(t[15]=e=>o.currentView="channel"),class:"suggestion-btn"},[b(a,{name:"globe",size:"sm"}),t[39]||(t[39]=C(" 查看通用優惠 "))])])):v("",!0),p("div",Xn,[p("button",{onClick:t[16]||(t[16]=t=>e.$emit("get-location")),class:"retry-btn"},[b(a,{name:"refresh",size:"sm"}),t[40]||(t[40]=C(" 重新定位 "))]),p("button",{onClick:t[17]||(t[17]=(...e)=>r.expandSearch&&r.expandSearch(...e)),class:"expand-btn"},[b(a,{name:"zoom-out",size:"sm"}),t[41]||(t[41]=C(" 擴大搜尋範圍至10公里 "))]),p("button",{onClick:t[18]||(t[18]=e=>o.showCustomLocationInEmptyState=!o.showCustomLocationInEmptyState),class:"expand-btn"},[b(a,{name:"search",size:"sm"}),t[42]||(t[42]=C(" 手動輸入位置 "))])])]),o.showCustomLocationInEmptyState?(y(),m("div",Jn,[b(i,{onLocationSelected:r.handleEmptyStateLocationSelected},null,8,["onLocationSelected"])])):v("",!0)])):(y(),m("div",un,[p("div",fn,[b(a,{name:"location",size:"lg",class:"text-blue-500"}),t[21]||(t[21]=p("h3",{class:"prompt-title"},"設定您的位置",-1)),t[22]||(t[22]=p("p",{class:"prompt-text"},"使用GPS定位或手動輸入地址來找到附近的員工專屬優惠",-1)),p("div",dn,[p("button",{onClick:t[4]||(t[4]=t=>e.$emit("get-location")),class:"get-location-btn primary"},[b(a,{name:"navigation",size:"sm"}),t[19]||(t[19]=C(" 使用GPS定位 "))]),p("button",{onClick:t[5]||(t[5]=e=>o.showCustomLocation=!o.showCustomLocation),class:"custom-location-btn"},[b(a,{name:"search",size:"sm"}),t[20]||(t[20]=C(" 手動輸入地址 "))])])]),o.showCustomLocation?(y(),m("div",hn,[b(i,{onLocationSelected:r.handleCustomLocation},null,8,["onLocationSelected"])])):v("",!0)])),"nearby"===o.currentView&&e.nearbyPhysicalOffers.length>0||"channel"===o.currentView&&e.channelOffers.length>0?(y(),m("div",Yn,[p("h4",Zn,[b(a,{name:"lightbulb",size:"sm",class:"text-yellow-500"}),t[45]||(t[45]=C(" 使用便利貼 "))]),t[46]||(t[46]=p("ul",{class:"tips-list"},[p("li",null,"點擊優惠卡片查看詳細使用說明"),p("li",null,"直接撥打電話確認優惠是否仍有效"),p("li",null,"建議在前往前先致電確認營業時間")],-1))])):v("",!0)])}],["__scopeId","data-v-6f8dbd4c"]]),ts={name:"OfferModal",components:{Icon:wt},props:{offer:{type:Object,default:null},isVisible:{type:Boolean,default:!1}},computed:{walkTime(){var e;if(!(null==(e=this.offer)?void 0:e.distance))return 0;const t=this.offer.distance/5,n=Math.round(60*t);return Math.max(1,n)}},methods:{closeModal(){this.$emit("close")},callStore(){var e,t;(null==(t=null==(e=this.offer)?void 0:e.store)?void 0:t.phone)&&window.open(`tel:${this.offer.store.phone}`)},getDirections(){var e,t,n,s;if((null==(t=null==(e=this.offer)?void 0:e.store)?void 0:t.lat)&&(null==(s=null==(n=this.offer)?void 0:n.store)?void 0:s.lng)){const e=`https://www.google.com/maps/dir/current+location/${this.offer.store.lat},${this.offer.store.lng}`;window.open(e,"_blank")}},shareOffer(){const e=`${this.offer.store.name} - ${this.offer.title}: ${this.offer.description}`;navigator.share?navigator.share({title:this.offer.title,text:e,url:window.location.href}).catch(e=>{"AbortError"!==e.name&&console.error("分享失敗:",e)}):navigator.clipboard.writeText(e).then(()=>{this.$emit("show-toast",{message:"優惠資訊已複製到剪貼簿",type:"success"})}).catch(()=>{this.$emit("show-toast",{message:"複製失敗，請手動複製",type:"error"})})},getOfferIcon:e=>({discount:"percentage",cashback:"dollar",gift:"gift",member:"user",bundle:"package"}[e]||"tag"),getOfferTypeLabel:e=>({discount:"折扣優惠",cashback:"現金回饋",gift:"贈品活動",member:"會員專屬",bundle:"套餐組合"}[e]||"優惠活動"),formatValidityDate(e){const t=new Date(e)-new Date,n=Math.ceil(t/864e5);return n<0?"已過期":0===n?"今日截止":1===n?"明日截止":n<=7?`${n}天後截止`:n<=30?`約${Math.ceil(n/7)}週後截止`:"長期有效"},getValidityClass(e){const t=new Date(e)-new Date,n=Math.ceil(t/864e5);return n<0?"expired":n<=3?"urgent":n<=7?"soon":"normal"},isUrgent(e){const t=new Date(e)-new Date,n=Math.ceil(t/864e5);return n>=0&&n<=3}},watch:{isVisible(e){e?(document.body.style.overflow="hidden",this.$nextTick(()=>{const e=document.querySelector(".modal-content");e&&e.focus()})):document.body.style.overflow=""}},emits:["close","show-toast"]},ns=["aria-labelledby"],ss={key:0,class:"modal-body"},os={class:"offer-badges-modal"},rs={key:0,class:"community-badge-modal"},as={key:2,class:"offer-badge community-only-modal"},is=["id"],ls={class:"store-section"},cs={class:"store-header"},us={class:"store-details"},fs={class:"store-name"},ds={class:"store-meta"},hs={class:"category"},ms={class:"location-info"},ps={class:"address"},gs={key:0,class:"distance"},ys={class:"offer-section"},vs={class:"section-title"},bs={class:"offer-content"},ws={class:"offer-type"},ks={class:"offer-description"},Cs={class:"usage-section"},Os={class:"section-title"},xs={class:"validity-section"},Ss={class:"section-title"},Ls={class:"validity-content"},Es={key:0,class:"urgent-notice"},Ms={class:"hours-section"},zs={class:"section-title"},Is={class:"hours-text"},Ps={class:"action-buttons"};const $s={id:"app",class:"app-container"},Rs={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 md:py-8"},Ts={key:0,class:"flex flex-col justify-center items-center py-16",role:"status","aria-live":"polite"},As={class:"mt-4 text-center"},Vs={class:"text-lg font-medium text-gray-700"},js={key:1,class:"text-center py-16",role:"alert","aria-live":"assertive"},_s={class:"bg-red-50 rounded-2xl p-8 max-w-md mx-auto"},Ds={class:"text-red-600 mb-4"},qs={key:2},Us={key:0,class:"fixed top-4 left-4 right-4 md:top-8 md:left-auto md:right-8 md:max-w-md bg-red-500 text-white px-4 py-3 md:px-6 md:py-4 rounded-xl md:rounded-2xl shadow-2xl z-50 border border-red-400 backdrop-blur-sm"},Fs={class:"flex items-center"},Qs={class:"bg-red-400 rounded-full p-1 mr-3 flex-shrink-0"},Gs={class:"font-medium flex-1 text-sm md:text-base"};const Hs={class:"selector-container"},Bs={class:"selector-buttons"};const Ns=[{path:"/:companyId",name:"CompanyOffers",component:gt({name:"App",props:["companyId"],components:{OfferList:es,OfferModal:gt(ts,[["render",function(e,t,n,s,o,r){var a,i;const l=w("Icon");return n.isVisible?(y(),m("div",{key:0,class:"modal-overlay",onClick:t[5]||(t[5]=(...e)=>r.closeModal&&r.closeModal(...e)),onKeydown:t[6]||(t[6]=x((...e)=>r.closeModal&&r.closeModal(...e),["esc"]))},[p("div",{class:"modal-content",onClick:t[4]||(t[4]=O(()=>{},["stop"])),role:"dialog","aria-modal":"true","aria-labelledby":`offer-title-${null==(i=null==(a=n.offer)?void 0:a.store)?void 0:i.id}`},[p("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>r.closeModal&&r.closeModal(...e)),"aria-label":"關閉優惠詳情"},[b(l,{name:"close",size:"lg"})]),n.offer?(y(),m("div",ss,[p("div",os,[n.offer.communityRecommended||n.offer.featured?(y(),m("div",rs,[b(l,{name:"heart",size:"sm"}),t[7]||(t[7]=p("span",null,"社群推薦",-1))])):v("",!0),null!==n.offer.isEmployeeOffer&&void 0!==n.offer.isEmployeeOffer?(y(),m("div",{key:1,class:g(["offer-badge",n.offer.isEmployeeOffer?"employee-exclusive":"public-offer"])},[b(l,{name:n.offer.isEmployeeOffer?"user":"users",size:"sm"},null,8,["name"]),p("span",null,k(n.offer.isEmployeeOffer?"員工專享優惠":"一般優惠"),1)],2)):n.offer.communityRecommended||n.offer.featured?(y(),m("div",as,[b(l,{name:"star",size:"sm"}),t[8]||(t[8]=p("span",null,"社群推薦店家",-1))])):v("",!0)]),p("h2",{class:"offer-title",id:`offer-title-${n.offer.store.id}`},k(n.offer.title),9,is),p("div",ls,[p("div",cs,[b(l,{name:"store",size:"lg",class:"text-primary"}),p("div",us,[p("h3",fs,k(n.offer.store.name),1),p("div",ds,[p("span",hs,k(n.offer.store.category),1)])])]),p("div",ms,[p("div",ps,[b(l,{name:"location",size:"sm",class:"text-gray-500"}),p("span",null,k(n.offer.store.address),1)]),n.offer.distance?(y(),m("div",gs,[b(l,{name:"navigation",size:"sm",class:"text-blue-500"}),p("span",null,"距離約 "+k(n.offer.distance)+"km (步行 "+k(r.walkTime)+" 分鐘)",1)])):v("",!0)])]),p("div",ys,[p("h4",vs,[b(l,{name:"tag",size:"sm",class:"text-accent"}),t[9]||(t[9]=C(" 優惠內容 "))]),p("div",bs,[p("div",ws,[p("span",{class:g(["type-badge",`type-${n.offer.type}`])},[b(l,{name:r.getOfferIcon(n.offer.type),size:"sm"},null,8,["name"]),C(" "+k(r.getOfferTypeLabel(n.offer.type)),1)],2)]),p("p",ks,k(n.offer.description),1)])]),p("div",Cs,[p("h4",Os,[b(l,{name:"info",size:"sm",class:"text-blue-500"}),t[10]||(t[10]=C(" 使用須知 "))]),t[11]||(t[11]=p("div",{class:"usage-content"},[p("ul",{class:"usage-list"},[p("li",null,"請主動出示員工證件供店家核對"),p("li",null,"優惠不可與其他促銷活動併用"),p("li",null,"店家保留活動最終解釋權"),p("li",null,"建議事先致電確認優惠仍有效")])],-1))]),p("div",xs,[p("h4",Ss,[b(l,{name:"clock",size:"sm",class:"text-orange-500"}),t[12]||(t[12]=C(" 有效期限 "))]),p("div",Ls,[p("span",{class:g(["validity-date",r.getValidityClass(n.offer.validUntil)])},k(r.formatValidityDate(n.offer.validUntil)),3),r.isUrgent(n.offer.validUntil)?(y(),m("div",Es,[b(l,{name:"warning",size:"sm",class:"text-red-500"}),t[13]||(t[13]=p("span",null,"即將到期，請盡快使用！",-1))])):v("",!0)])]),p("div",Ms,[p("h4",zs,[b(l,{name:"clock",size:"sm",class:"text-green-500"}),t[14]||(t[14]=C(" 營業時間 "))]),p("p",Is,k(n.offer.store.openingHours),1)]),p("div",Ps,[p("button",{onClick:t[1]||(t[1]=(...e)=>r.callStore&&r.callStore(...e)),class:"action-btn primary"},[b(l,{name:"phone",size:"sm"}),p("span",null,k(n.offer.store.phone),1)]),p("button",{onClick:t[2]||(t[2]=(...e)=>r.getDirections&&r.getDirections(...e)),class:"action-btn secondary"},[b(l,{name:"map",size:"sm"}),t[15]||(t[15]=p("span",null,"開啟導航",-1))]),p("button",{onClick:t[3]||(t[3]=(...e)=>r.shareOffer&&r.shareOffer(...e)),class:"action-btn tertiary"},[b(l,{name:"share",size:"sm"}),t[16]||(t[16]=p("span",null,"分享優惠",-1))])])])):v("",!0)],8,ns)],32)):v("",!0)}],["__scopeId","data-v-321950f8"]]),Icon:wt},data:()=>({isGettingLocation:!1,locationError:null,selectedOffer:null,showOfferModal:!1}),computed:{storeStore:()=>ht(),allStores(){return this.storeStore.allStores},nearbyOffers(){return this.storeStore.nearbyOffers},userLocation(){return this.storeStore.userLocation},isLoading(){return this.storeStore.isLoading},error(){return this.storeStore.error}},methods:{async loadStores(){this.companyId?await this.storeStore.loadStores(this.companyId):this.$router.push({name:"Selector"})},handleOfferSelected(e){this.selectedOffer=e,this.showOfferModal=!0},closeOfferModal(){this.showOfferModal=!1,this.selectedOffer=null},showToast(e){console.log("Toast:",e.message)},handleCustomLocation(e){this.storeStore.setUserLocation({lat:e.lat,lng:e.lng,address:e.address,name:e.name})},async getCurrentLocation(){this.isGettingLocation=!0,this.locationError=null;try{await this.storeStore.getCurrentLocation()}catch(e){this.locationError=e.message,setTimeout(()=>{this.locationError=null},5e3)}finally{this.isGettingLocation=!1}}},async mounted(){await this.loadStores(),!this.storeStore.error&&this.companyId&&this.getCurrentLocation()}},[["render",function(e,t,n,s,o,r){const a=w("Icon"),i=w("OfferList"),l=w("OfferModal");return y(),m("div",$s,[t[5]||(t[5]=p("header",{class:"app-header"},[p("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},[p("div",{class:"flex items-center py-2"},[p("h1",{class:"app-title"},"優惠探索")])])],-1)),p("main",Rs,[r.isLoading||o.isGettingLocation?(y(),m("div",Ts,[t[3]||(t[3]=p("div",{class:"relative","aria-hidden":"true"},[p("div",{class:"animate-spin rounded-full h-16 w-16 border-4 border-blue-200"}),p("div",{class:"animate-spin rounded-full h-16 w-16 border-4 border-blue-600 border-t-transparent absolute top-0"})],-1)),p("div",As,[p("p",Vs,k(r.isLoading?"載入店家資料中":"正在尋找您附近的優惠"),1),t[2]||(t[2]=p("p",{class:"text-sm text-gray-500 mt-1"},"請稍候...",-1))])])):r.error?(y(),m("div",js,[p("div",_s,[b(a,{name:"error",size:"lg",spacing:"none",class:"text-red-400 mx-auto mb-4","aria-hidden":!0}),t[4]||(t[4]=p("h2",{class:"text-lg font-semibold text-red-800 mb-2"},"載入失敗",-1)),p("p",Ds,k(r.error),1),p("button",{onClick:t[0]||(t[0]=(...e)=>r.loadStores&&r.loadStores(...e)),class:"px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-all duration-200 font-medium shadow-lg","aria-label":"重新載入店家資料"}," 重新載入 ")])])):(y(),m("div",qs,[b(i,{offers:r.nearbyOffers,"user-location":r.userLocation,onOfferSelected:r.handleOfferSelected,onGetLocation:r.getCurrentLocation,onCustomLocationSelected:r.handleCustomLocation},null,8,["offers","user-location","onOfferSelected","onGetLocation","onCustomLocationSelected"])]))]),b(l,{offer:o.selectedOffer,"is-visible":o.showOfferModal,onClose:r.closeOfferModal,onShowToast:r.showToast},null,8,["offer","is-visible","onClose","onShowToast"]),o.locationError?(y(),m("div",Us,[p("div",Fs,[p("div",Qs,[b(a,{name:"error",size:"sm",spacing:"none","aria-hidden":!0})]),p("span",Gs,k(o.locationError),1),p("button",{onClick:t[1]||(t[1]=e=>o.locationError=null),class:"ml-3 hover:bg-red-400 p-1 rounded-full transition-colors duration-200 flex-shrink-0"},[b(a,{name:"close",size:"sm",spacing:"none","aria-hidden":!0})])])])):v("",!0)])}],["__scopeId","data-v-ee9c92c0"]]),props:!0},{path:"/",name:"Selector",component:gt({name:"CompanySelector",created(){const e=localStorage.getItem("selectedCompany");e&&this.$router.replace({name:"CompanyOffers",params:{companyId:e}})},methods:{selectCompany(e){localStorage.setItem("selectedCompany",e),this.$router.push({name:"CompanyOffers",params:{companyId:e}})}}},[["render",function(e,t,n,s,o,r){return y(),m("div",Hs,[t[2]||(t[2]=p("h1",{class:"selector-title"},"員工專屬優惠平台",-1)),t[3]||(t[3]=p("p",{class:"selector-subtitle"},"請選擇您所屬的單位",-1)),p("div",Bs,[p("button",{onClick:t[0]||(t[0]=e=>r.selectCompany("moda")),class:"selector-btn"}," 數位發展部 "),p("button",{onClick:t[1]||(t[1]=e=>r.selectCompany("npa")),class:"selector-btn"}," 內政部警政署 ")])])}],["__scopeId","data-v-63d4784d"]])}],Ws=function(t){const o=Fe(t.routes,t),r=t.parseQuery||Xe,a=t.stringifyQuery||Je,i=t.history,l=ot(),u=ot(),f=ot(),d=e(fe);let h=fe;R&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const m=V.bind(null,e=>""+e),p=V.bind(null,ne),g=V.bind(null,se);function y(e,t){if(t=A({},t||d.value),"string"==typeof e){const n=re(r,e,t.path),s=o.resolve({path:n.path},t),a=i.createHref(n.fullPath);return A(n,s,{params:g(s.params),hash:se(n.hash),redirectedFrom:void 0,href:a})}let n;if(null!=e.path)n=A({},e,{path:re(r,e.path,t.path).path});else{const s=A({},e.params);for(const e in s)null==s[e]&&delete s[e];n=A({},e,{params:p(s)}),t.params=p(t.params)}const s=o.resolve(n,t),l=e.hash||"";s.params=m(g(s.params));const c=function(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}(a,A({},e,{hash:(u=l,Z(u).replace(K,"{").replace(J,"}").replace(N,"^")),path:s.path}));var u;const f=i.createHref(c);return A({fullPath:c,hash:l,query:a===Je?Ye(e.query):e.query||{}},s,{redirectedFrom:void 0,href:f})}function v(e){return"string"==typeof e?re(r,e,d.value.path):A({},e)}function b(e,t){if(h!==e)return Pe(8,{from:t,to:e})}function w(e){return C(e)}function k(e){const t=e.matched[e.matched.length-1];if(t&&t.redirect){const{redirect:n}=t;let s="function"==typeof n?n(e):n;return"string"==typeof s&&(s=s.includes("?")||s.includes("#")?s=v(s):{path:s},s.params={}),A({query:e.query,hash:e.hash,params:null!=s.path?{}:e.params},s)}}function C(e,t){const n=h=y(e),s=d.value,o=e.state,r=e.force,i=!0===e.replace,l=k(n);if(l)return C(A(v(l),{state:"object"==typeof l?A({},o,l.state):o,force:r,replace:i}),t||n);const c=n;let u;return c.redirectedFrom=t,!r&&function(e,t,n){const s=t.matched.length-1,o=n.matched.length-1;return s>-1&&s===o&&ie(t.matched[s],n.matched[o])&&le(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}(a,s,n)&&(u=Pe(16,{to:c,from:s}),q(s,s,!0,!1)),(u?Promise.resolve(u):S(c,s)).catch(e=>$e(e)?$e(e,2)?e:D(e):T(e,c,s)).then(e=>{if(e){if($e(e,2))return C(A({replace:i},v(e.to),{state:"object"==typeof e.to?A({},o,e.to.state):o,force:r}),t||c)}else e=E(c,s,!0,i,o);return L(c,s,e),e})}function O(e,t){const n=b(e,t);return n?Promise.reject(n):Promise.resolve()}function x(e){const t=Q.values().next().value;return t&&"function"==typeof t.runWithContext?t.runWithContext(e):e()}function S(e,t){let n;const[s,o,r]=function(e,t){const n=[],s=[],o=[],r=Math.max(t.matched.length,e.matched.length);for(let a=0;a<r;a++){const r=t.matched[a];r&&(e.matched.find(e=>ie(e,r))?s.push(r):n.push(r));const i=e.matched[a];i&&(t.matched.find(e=>ie(e,i))||o.push(i))}return[n,s,o]}(e,t);n=at(s.reverse(),"beforeRouteLeave",e,t);for(const i of s)i.leaveGuards.forEach(s=>{n.push(rt(s,e,t))});const a=O.bind(null,e,t);return n.push(a),H(n).then(()=>{n=[];for(const s of l.list())n.push(rt(s,e,t));return n.push(a),H(n)}).then(()=>{n=at(o,"beforeRouteUpdate",e,t);for(const s of o)s.updateGuards.forEach(s=>{n.push(rt(s,e,t))});return n.push(a),H(n)}).then(()=>{n=[];for(const s of r)if(s.beforeEnter)if(_(s.beforeEnter))for(const o of s.beforeEnter)n.push(rt(o,e,t));else n.push(rt(s.beforeEnter,e,t));return n.push(a),H(n)}).then(()=>(e.matched.forEach(e=>e.enterCallbacks={}),n=at(r,"beforeRouteEnter",e,t,x),n.push(a),H(n))).then(()=>{n=[];for(const s of u.list())n.push(rt(s,e,t));return n.push(a),H(n)}).catch(e=>$e(e,8)?e:Promise.reject(e))}function L(e,t,n){f.list().forEach(s=>x(()=>s(e,t,n)))}function E(e,t,n,s,o){const r=b(e,t);if(r)return r;const a=t===fe,l=R?history.state:{};n&&(s||a?i.replace(e.fullPath,A({scroll:a&&l&&l.scroll},o)):i.push(e.fullPath,o)),d.value=e,q(e,t,n,a),D()}let M;function z(){M||(M=i.listen((e,t,n)=>{if(!G.listening)return;const s=y(e),o=k(s);if(o)return void C(A(o,{replace:!0,force:!0}),s).catch(j);h=s;const r=d.value;var a,l;R&&(a=ke(r.fullPath,n.delta),l=be(),Ce.set(a,l)),S(s,r).catch(e=>$e(e,12)?e:$e(e,2)?(C(A(v(e.to),{force:!0}),s).then(e=>{$e(e,20)&&!n.delta&&n.type===de.pop&&i.go(-1,!1)}).catch(j),Promise.reject()):(n.delta&&i.go(-n.delta,!1),T(e,s,r))).then(e=>{(e=e||E(s,r,!1))&&(n.delta&&!$e(e,8)?i.go(-n.delta,!1):n.type===de.pop&&$e(e,20)&&i.go(-1,!1)),L(s,r,e)}).catch(j)}))}let I,P=ot(),$=ot();function T(e,t,n){D(e);const s=$.list();return s.length?s.forEach(s=>s(e,t,n)):console.error(e),Promise.reject(e)}function D(e){return I||(I=!e,z(),P.list().forEach(([t,n])=>e?n(e):t()),P.reset()),e}function q(e,n,s,o){const{scrollBehavior:r}=t;if(!R||!r)return Promise.resolve();const a=!s&&function(e){const t=Ce.get(e);return Ce.delete(e),t}(ke(e.fullPath,0))||(o||!s)&&history.state&&history.state.scroll||null;return c().then(()=>r(e,n,a)).then(e=>e&&we(e)).catch(t=>T(t,e,n))}const U=e=>i.go(e);let F;const Q=new Set,G={currentRoute:d,listening:!0,addRoute:function(e,t){let n,s;return Ee(e)?(n=o.getRecordMatcher(e),s=t):s=e,o.addRoute(s,n)},removeRoute:function(e){const t=o.getRecordMatcher(e);t&&o.removeRoute(t)},clearRoutes:o.clearRoutes,hasRoute:function(e){return!!o.getRecordMatcher(e)},getRoutes:function(){return o.getRoutes().map(e=>e.record)},resolve:y,options:t,push:w,replace:function(e){return w(A(v(e),{replace:!0}))},go:U,back:()=>U(-1),forward:()=>U(1),beforeEach:l.add,beforeResolve:u.add,afterEach:f.add,onError:$.add,isReady:function(){return I&&d.value!==fe?Promise.resolve():new Promise((e,t)=>{P.add([e,t])})},install(e){e.component("RouterLink",lt),e.component("RouterView",dt),e.config.globalProperties.$router=this,Object.defineProperty(e.config.globalProperties,"$route",{enumerable:!0,get:()=>n(d)}),R&&!F&&d.value===fe&&(F=!0,w(i.location).catch(e=>{}));const t={};for(const n in fe)Object.defineProperty(t,n,{get:()=>d.value[n],enumerable:!0});e.provide(tt,this),e.provide(nt,s(t)),e.provide(st,d);const o=e.unmount;Q.add(e),e.unmount=function(){Q.delete(e),Q.size<1&&(h=fe,M&&M(),M=null,d.value=fe,F=!1,I=!1),o()}}};function H(e){return e.reduce((e,t)=>e.then(()=>x(t)),Promise.resolve())}return G}({history:((Ks=location.host?Ks||location.pathname+location.search:"").includes("#")||(Ks+="#"),Le(Ks)),routes:Ns});var Ks;const Xs=P(gt({name:"RootApp"},[["render",function(e,t,n,s,o,r){const a=w("router-view");return y(),I(a)}]])),Js=$();Xs.use(Js),Xs.use(Ws),Xs.mount("#app");
